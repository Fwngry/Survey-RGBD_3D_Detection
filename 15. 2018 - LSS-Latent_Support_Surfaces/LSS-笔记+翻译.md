LSS - 潜在支持面

> （室内场景）3D目标检测，based COG，针对同一类别不同物体的风格差异，以及大搜索空间下的小物体检测。
>
> 高度作为一个潜在的变量，用它区分同一类别的不同视觉风格
>
> 分层形状的小物体（如梳妆台和床头柜）
>
> 利用场景布局特征，我们还看到了对那些方向与墙壁方向密切相关的物体的改进，如床和书架。

## 0. 摘要

我们开发了一种三维物体检测算法，该算法使用**潜在支持面**来捕捉室内场景中的背景关系。现有的RGB-D图像的三维表示法，可以捕捉到物体类别的局部形状和外观，**但对具有不同视觉风格的物体的表示能力有限。**（小物体、大搜索空间）对小物体的检测也很有挑战性，因为在三维场景中搜索空间非常大。然而，我们观察到，三维物体类别中的大部分形状变化可以由潜在的支持面的位置来解释，而**较小的物体往往被较大的物体支持**。因此，我们明确地使用<u>潜伏支持面latent support surfaces</u> 来更好地表示大型物体的三维外观，并提供上下文线索来改善小型物体的检测。我们用SUN RGB-D数据库中的19个物体类别来评估我们的模型，并展示了最先进的性能。**减小搜索空间**

## 1. 引言

给定一个RGB-D图像，三维物体检测的目标是恢复三维边界盒，捕捉物体在场景中占据的立方体空间。这种表示方法比二维边界盒更强大。

<u>在室内场景中</u>，三维边界框编码了物体的**空间范围**，这可以帮助自主机器人更好地与环境互动。

<u>在室外场景中</u>，三维边界框还包含了关于**物体方向的信息**，这对自主驾驶的应用至关重要[4]。

**【问题】**

1. 同一类别中的不同物体，按不同的视觉风格进行建模往往是非常具有挑战性的[10]。
2. 而且不同的人类注释者对三维立方体的地面真实注释也会有所不同（见图1）。
3. 物理尺寸较小的物体很难被检测到，因为整个场景的搜索空间非常大，而且自下而上的建议通常包含许多假阳性。

<u>目前最先进的三维物体特征，如COG[34]和TSDF[40]，是针对每个假设的三维立方体中的体素网格计算的。</u>

**【解决方案】**

<u>不同物体实例之间，特征不一致的原因，是许多室内物体所包含的支撑面位置的变化。我们将支撑面的高度作为一个潜在的变量，用它来区分同一物体类别的不同视觉风格。</u>

对支撑面进行建模也可以帮助检测较小的物体，如显示器、灯具、电视和枕头。由于小物体通常被放置在大物体的支撑面上，我们首先检测地面上的大物体并预测它们的支撑面位置，然后在支撑面区域上面搜索小物体。对小物体的搜索空间的减少自然会减少误报并提高性能。

在Ren等人[34]COG的级联三维场景理解框架的基础上，本文的贡献包括引入新的三维视图特征，<u>改善三维检测系统，将支持面建模，捕捉大型物体类内变化的潜在变量，准确地检测小型物体。</u>我们在SUN RGB-D数据集[38]上评估了我们的算法，并在19个物体类别的三维检测中实现了最先进的准确性。

## 2. 相关工作

**三维物体检测** 

- 在<u>室外场景</u>中，用三维立方体进行物体定位已经成为流行的KITTI自动驾驶基准[12]的一个新标准。三维检测系统使用激光雷达或立体声输入对汽车形状和遮挡模式进行建模[4, 28, 46]，还可能纳入额外的鸟瞰数据[5]。然而**，室外三维检测的方法通常集中于识别开放场景中的车辆和行人，而不能适用于杂乱场景中更具挑战性的检测任务。**

- 在<u>室内场景</u>中，通常有更多的物体类别，而且类别的形状和风格变化更大。由于室内物体经常被其杂乱的环境严重遮挡，用三维立方体[25, 16]而不是二维边界盒来定位物体可能更有用。

**3D检测方法**

一些工作将三维CAD模型与RGB-D输入的物体对齐[17, 39]，正如在小规模的纽约大学深度数据集[37]上评估的那样，但计算成本通常很高。

Voxnet 一个简单的三维卷积神经网络被设计用来实时检测简单的物体[27]。

其他工作利用预训练的二维检测器或区域建议作为先验，并通过一个单独的CNN定位三维边界框[40, 8, 23]。**这些方法可以在很大的计算速度下取得良好的性能，但对二维物体提议的准确性非常敏感。**

Ren等人[34]引入了定向梯度云（COG）来表示三维立方体，并通过一个级联预测框架[20]进行整体场景理解。尽管这项工作在SUN RGB-D数据集[38]上对10个大型物体类别实现了最先进的性能，但**它不能直接用于检测较小的物体**，因为它需要在三维空间进行详尽的搜索。此外，COG特征并不能捕捉到物体的风格变化。

**支撑面预测** 

检测支撑面是理解三维场景的几何形状的重要第一步，用于表面法线估计[44, 11]和形状检索[2]等任务。

Silberman等人[37]使用语义分割来模拟物体的支持关系；

Guo等人[15]扩展为支持面预测。

然而，支持面以前还没有被用来实现三维物体检测。在这项工作中，我们将支持面作为潜在变量来捕捉物体的风格变化，并利用它们来定位小物体。我们在SUN RGB-D数据集[38]上证明了我们的3D物体检测框架的有效性。

## 3. LSS

**室内物体具有非常多样的视觉风格，要设计一套持续变化的潜在部分是非常有挑战性的。对于许多物体类别，支撑面的高度是导致风格变化的主要原因（图3）**。因此，我们明确地将支撑面建模为每个物体的潜在部分。

**通过对支撑面建模，我们还可以限制小物体检测器的搜索空间。**这样的检测器否则是难以学习的，并且由于可能的三维姿势的大集合而表现不佳[34]。

我们沿用了Ren等人[34]的符号，更新了学习目标：
对于每个类别的c，我们的目标是学习一个预测函数I → (B, h)，该函数将RGB-D图像I，与它的相对表面高度h和三维边界盒B = (L, θ, S, y)一起映射。L是三维长方体的中心，θ是长方体的方向，S是长方体沿由其方向决定的三个轴的物理尺寸，y是代表这种预测存在的指标变量，潜在变量h被定义为与长方体底部的相对表面高度。我们将长方体的高度离散为7个片断，h将支持面定位于这7个片断之一（见图4）

### 小物体检测

在室内场景中，除了大型家具，许多尺寸相对较小的物体也很难被检测到[40, 34]。

一些算法被专门设计为使用多尺度方法检测二维图像中的小物体[3, 21]，但它们不能直接应用于三维物体检测。

**检测小物体的最大问题是，搜索空间可能是巨大的，因此用基于滑动窗口的方法进行训练和测试通常是难以实现的。**<u>但要注意的是，小物体，如枕头和显示器和灯，通常是放在其他有支撑面的物体上面的。如果我们只在预测的支持面上搜索小物体，搜索空间将大大减少。因此，推理速度将得到提高，物体建议中的假阳性也会减少。这是支持面建模的另一个好处。</u>

**在我们的实施中，我们首先检测室内场景中在地面上的大型物体[34]，然后我们只在这些大型物体的支持面上搜索小型物体，并给出肯定的分数。**<u>我们将灯具和枕头的体素分解大小减少到3×3×3，因为小的立方体包含较少的像素，而显示器和电视的体素分解大小为3×1×3，因为它们的形状很薄。</u>

### 所有物体的空间场景学习

**问题：各类别分开进行鉴别训练+相似的几何形状 -> 误检**

**解决方案：效仿COG，使用级联检测框架，确定性最高的立方体建议的上下文关系进行编码。**

我们的物体检测器，是**针对每个物体类别进行鉴别性训练**的。在测试时，具有局部相似形状的三维物体会混淆为每个物体类别独立训练的三维检测器。我们没有设计简单的启发式方法来处理假阳性，而是效仿Ren等人[34]，使用有效的级联检测框架[20]来模拟立方体建议之间的上下文关系。

对于每个三维立方体建议，我们使用三维重叠特征和一致性差异，对其余所有物体类别中确定性最高的立方体建议的上下文关系进行编码。利用这些上下文特征，我们学习了一个线性SVM来确定这些三维物体建议是否正确，并将这个更新的确定性分数添加到第一阶段的检测分数中。我们请读者参考Ren等人[34]的补充材料以了解详细的解释。

对于放置在大物体支撑面上的小物体，三维重叠特征是有噪声的。我们用场景的自上而下的视图计算二维与三维边界框的重叠（图5）。有了考虑到original beliefs and contextual cues的更新的置信分数，物体建议包含更少的假阳性，物体检测器的性能也得到了提高。

## 4. 实验

**建模潜在支撑表面** 

对于床、桌子和书桌等物体，将支撑面建模为一个潜在的变量，有助于捕捉每个立方体中的类内风格变化，我们在表1的第三行看到了<u>巨大的性能提升</u>。我们在图7中直观地展示了推断出的支持面的例子。

对于没有明确的 "支持面 "的物体，如浴缸、书架和水槽，我们的模型<u>可以被看作是基于单一部件的模型</u>，对三维物体检测也是有效的。（请注意，这项工作的目标是为潜在的支撑面建模，以帮助三维检测，而不是预测场景的准确支撑面面积。我们在训练时不使用任何支持面的注释，也不在表面预测的基准上评估我们的性能[15]。）

**小物体检测** 

检测小物体是一项具有挑战性的任务，仍然是一个开放的问题。<u>在没有建立支持面模型的情况下，我们的基线方法无法检测到小物体，因为搜索空间很大，而且三维物体建议包含许多假阳性。</u>使用简单的启发式方法来检查SUN-RGBD注释中的支持关系，我们发现超过95%的灯具/枕头/显示器/电视被放置在床头柜/桌子/床/桌子/梳妆台的表面。在预测的表面区域进行搜索使我们的算法能够以更高的精度发现小物体。见表1的第3行。

**与其他方法的比较**

通过对潜伏支持面建模，我们的算法已经超过了Ren等人[34]的最先进的方法，适用于10个大的物体类别，并且还可以检测一些较小的物体。在本文中，我们的主要目标是证明潜伏支持面建模的有效性，并且我们认为目前的系统已经显示出巨大的潜力。

与其他使用CNN特征的算法[40, 23]在外部数据集上预训练的算法相比，即使没有<u>级联预测步骤</u>，我们的算法的性能也是相当的。用于3D检测的传统CNN[40, 23]被训练成为多个物体类别的加权确信分数，而我们的第一阶段检测算法则被调整为辨别性的。

我们的第一阶段检测算法被调整为辨别性地定位三维中的单个类别。我们随后对物体检测之间的<u>上下文关系的级联预测</u>[20]在结构上与多级神经网络相似，但它是用（凸）结构SVM损失函数来训练的，并被设计为有一个更可解释的图形结构。<u>有趣的是，我们的级联方法在检测10个和19个物体类别时，与标准的三维CNN[40, 23]相当或更准确。</u>

**计算速度** 

- 我们使用MATLAB在2.5GHz单核CPU上实现了我们的算法。<u>我们算法的计算速度为每幅图像10-30分钟</u>，比Ren等人[34]的报告速度略好。
- 最耗时的部分是特征计算步骤，这可以通过使用多核CPU或GPU的并行计算来改善。在为每幅RGB-D图像预先计算立方体特征的情况下，<u>每个物体类别的推理时间为2秒</u>。
- 在所有物体中预先计算上下文特征的情况下，<u>级联预测框架的平均运行时间不到0.5秒</u>。

**失败案例** 

我们的算法的一个典型失败案例显示在图7的最后一行，其中缺失的深度值导致物体被遗漏。虽然当我们无法检测到小物体的支撑面时，确实会漏掉一些小物体，但考虑到**在高度杂乱的室内场景中检测小物体的极端困难，利用支撑关系进行三维检测仍有很大的净好处。**以前的一些工作是专门为解决这个问题而设计的[8, 23]，在RGB图像中使用CNN特征，我们相信在我们的级联预测框架中加入类似的方法也会有助于解决这个失败的案例。

## 结论

我们设计了一个使用潜在支撑面的三维物体检测系统。将支撑面的高度建模为一个潜在的变量，可以提高大型物体的检测性能，并限制小型物体检测器的搜索空间。通过一个级联预测框架，我们的检测器在SUN RGB-D数据集上实现了最先进的性能，证明了在三维物体检测中对支持面建模的有效性。