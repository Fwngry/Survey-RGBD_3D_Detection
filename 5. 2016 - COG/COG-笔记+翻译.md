## 摘要

我们为杂乱的室内场景中的三维（3D）物体检测和空间布局预测，开发了新的表示方法和算法。

1. **A cloud of gradient descriptor COG 定向梯度云描述符**：我们提出了一个定向梯度云（COG）描述符，将物体类别的二维外观和三维姿势联系起来，准确地模拟**透视投影**是如何影响**感知图像边界**的。
2. **Manhattan Voxel 曼哈顿体素**：更好地捕捉到常见室内环境的三维房间布局几何。
3. **Structure prediction framework 分类**：有效的分类规则，是通过一个**结构化的预测框架**来学习的，是三维立方体假设与RGB-D数据相匹配的算法。
4. **cascade of classifier 级联分类框架** ：捕获类别与布局的上下文关系，整体场景假设的准确性提高。

我们的模型仅从有注释的RGB-D图像中学习，没有CAD模型的帮助，但其性能大大超过了SUN RGB-D数据库中的最先进水平。避免使用CAD模型可以更容易地学习许多物体类别的检测器。

## 引言

各种各样的语义三维场景模型已经被开发出来，包括基于低层次体素表示的方法[20]。对广泛用于二维检测的边界盒进行概括，物体实例的三维尺寸、位置和方向可以由边界立方体（凸多面体）描述。

1. 一些方法将立方体模型应用于RGB或RGB-D数据[17, 16, 40]，但没有任何语义上的、高层次的场景理解。
2. 其他工作使用CRF对通过自下而上分组检测到的立方体进行分类[25]，或通过与已知CAD模型在 "滑动 "位置进行匹配而直接检测到三维物体[36]。
3. 最近的几篇论文将CAD模型作为室内场景理解的额外信息，通过学习物体形状的模型[39]或为基于外观的匹配幻化出替代的视角[1, 24, 23]。

（3D 模型不可能有所有的模型，因此集中于少数类别）虽然三维模型是一个潜在的强大的信息源，但并不存在丰富的所有类别的模型，因此这些方法通常集中在少数类别上（通常，只有椅子[1]）。

（一一匹配的并不精确）此外，基于实例的方法[36]可能在计算上是不精确的，因为需要将每个样本与每个测试图像相匹配。目前还不清楚需要多少个CAD模型来忠实地捕捉一个物体类别。

为了对室内场景的空间布局进行建模，许多方法假设了一个正交的 "曼哈顿 "结构[4]，并旨在推断出三维结构的二维投影。在[22]和[15]的基础上，Hedau等人[12]使用一个结构化的模型对布局假设进行排序，Schwing等人[33]提出了一个高效的积分表示，以有效地探索指数级的许多布局建议，而Zhang等人[41]则将深度线索纳入其中。对物体进行联合建模可以提高布局预测的准确性[13, 32]，但以前的工作主要集中在有限的环境中（例如，几乎总是与墙壁对齐的床），可能无法推广到更杂乱的场景中。其他工作使用点云数据来直接预测三维布局[25, 35]，但对RGB-D深度估计的错误很敏感。

级联分类框架：简单的场景解析算法独立检测每个类别，即使在非最大限度的抑制之后，也会引入许多假阳性。以前的工作使用了相当复杂的、人工设计的启发式方法来修剪错误的检测[36]，或者使用CAD模型和布局线索来共同建立场景模型[9]。在本文中，我们展示了一个*级联分类框架*[14]可以用来学习物体类别和整个房间布局之间的上下文关系，从而使视觉上独特的物体导致更高质量的整体场景解释。

> 我们提出了一个通用的框架，用于学习只使用RGB-D注释的多个物体类别的检测器。
>
> 在第2节中，我们介绍了一种新型的定向梯度云（COG）特征，它能将三维物体的姿势与二维图像的边界有力地联系起来。我们还介绍了一种新的曼哈顿体素表征的三维房间布局几何。
>
> 我们使用一个结构化的预测框架（第3节）来学习一种将三维立方体假设与RGB-D数据相匹配的算法，
>
> 一个级联分类器（第4节）来纳入来自其他物体实例和类别以及整体三维布局的上下文线索。
>
> 在第5节中，我们使用最近推出的大型SUN-RGBD数据集[35]来验证我们的方法，在那里我们以比最先进的CAD模型检测器[36]更高的精度检测到更多的类别。

定向梯度直方图描述符(HOG)  [5] 是许多目标检测方法 [6] 的原型。 

物体遮挡轮廓，而边缘是室内场景理解的基础。 梯度方向是由 3D 对象方向和透视投影决定的，所以在 2D 图像坐标中天真地提取的 HOG 描述符泛化很差。

## 2. Modeling 3D Geometry & Appearance

我们的物体检测器是从SUN-RGBD数据集[35]中的三维定向立方体注释中学习的，该数据集包含10,335幅RGB-D图像和19个标记的物体类别。我们将每个立方体离散成一个6×6×6的（大）体素网格，并为这些6 3=216个单元提取特征。体素的尺寸被缩放以匹配每个实例的大小。我们使用标准的描述符来描述观察到的深度图像的三维几何形状，并提出一个新颖的RGB外观的定向梯度云（COG）描述符。我们还提出了一个曼哈顿体素模型的三维房间布局几何学。

**Object Geometry: 3D Density and Orientation**

![image-20210701131908899](https://oj84-1259326782.cos.ap-chengdu.myqcloud.com/uPic/2021/07_01_image-20210701131908899.png)

**Clouds of Oriented Gradients (COG)**

定向梯度直方图（HOG）描述符[5]构成了许多有效物体检测方法的基础[6]。由于普通物体产生的强遮挡轮廓，边缘是室内场景理解的一个非常自然的基础。然而，梯度方向当然是由三维物体方向和透视投影决定的，所以在二维图像坐标中天真地提取的HOG描述符的概括性很差。

为了解决这个问题，以前的一些工作使用了三维CAD模型来幻化出各种合成视点所期望的边缘[23, 1]。其他的工作限制性地假设物体的部分是近平面的，这样就可以使用图像扭曲来对齐[7]，或者所有物体都有一个与房间的全球 "曼哈顿世界坐标 "对齐的三维姿势[13]。以前的一些HOG描述符的三维扩展[3, 31]假定给出了一个完整的三维模型或网格模型。在最近的独立研究中[37]，三维立方体假说被用来聚合来自深度卷积神经网络的标准二维特征，但这些特征与三维物体方向之间的关系没有被建模。我们的定向梯度云（COG）特征准确地描述了具有复杂三维几何形状的物体的三维外观，这些物体是由RGBD相机在任何方向上捕获的。

## COG - A cloud of gradient descriptor

提出用于depth img 的 3D geo描述符: COG

现阶段描述符的一些问题：

HOG 取决于3D投影和方向，聚合了二维特征，泛化能力差；

CAD：幻视边界 - 合成视角

COG方法：0-180度，寻找2D边界，累积无符号2D梯度，扭曲直方图bin而非扭曲图像；在相邻方向上使用双线性内插

## 一种基于学习的 曼哈顿体素化

给定一个RGB-D图像，场景解析需要房间布局（地板、天花板、墙壁）的预测[12, 22, 41, 32]。这对于像机器人导航是至关重要的。许多以前的方法将房间布局预测视为二维标签任务[2, 33, 41]，但二维的小错误会导致三维布局预测的巨大错误。简单的RGB-D布局预测方法[35]通过对观察到的点云数据进行<u>平面化处理</u>。

**我们提出了一种更精确的基于学习的方法来预测曼哈顿的几何形状。**

我们提出了一种新的曼哈顿体素（图3，右下角）离散化的三维布局预测方法。我们首先将地板和天花板之间的垂直空间离散成6个相等的仓。然后，我们使用0.15米的阈值，将靠近墙壁的点与假设布局的内部或外部的点分开。进一步使用对角线来分割房间角落的仓，整个空间被离散为12×6=72个仓。对于每个垂直层，区域R 1:4模拟场景内部，其点云分布在不同的图像中变化很大。区域R 5:8对假定的曼哈顿墙壁结构附近的点进行建模。R5和R6应包含正交平面，而R5和R7应包含平行平面。区域R9:12捕捉预测布局之外的点，如透明表面上的深度传感器误差可能产生的。

## 3. Learning to Detect Cuboids & Layouts

### 结构化预测长方体

对于每个独立的物体类别c，使用那些包含该类别可见实例的图像，我们的目标是学习一个预测函数h c : I → B，该函数将RGB-D图像I映射到一个三维边界盒B = (L, θ, S)。这里，L是三维长方体的中心，θ是长方体的方向，S是长方体沿由其方向决定的三个轴的物理尺寸。我们假设物体有一个底座，它们通常被支撑在上面，因此θ是一个相对于地平面的标量旋转。
给定c类的n个训练例子，我们使用结构支持向量机（SVM）目标的nslack表述[18]，并带有边际重构约束。

这里，φ(I i , B i )是给定RGB-D图像I i的定向长方体假设B i的特征，B i是地面真实注释的边界盒，B i是可能的替代边界盒的集合。对于具有多个实例的训练图像，如以前的二维检测工作[38]，我们将图像多次添加到训练集中，每次都会删除其他实例中包含的三维点子集。

考虑到一些地面真相立方体B和估计的立方体¯B，我们定义了以下损失函数。

这里，IOU(B, ¯B)是立方体的三维交叉点的体积，除以它们的三维结合点的体积。损失在0和1之间，当IOU(B, ¯B)接近1且方向误差θ-¯θ≈0时，损失最小。

我们使用切割面方法[18]来解决公式（1）的损失敏感目标。我们还试验了基于标准二元SVM的检测器，并进行了硬性负面挖掘，但发现损失敏感的S-SVM分类器更准确（见图5），在处理大量的负立方体假设时也更有效率。

### 长方体假设

我们使用离散的三维世界坐标以滑动窗口的方式预先计算候选长方体的特征，有16个候选方向。我们使用训练边界盒的经验统计来离散立方体的大小。{0.1, 0.3, 0.5, 0.7, 0.9}宽度量级，{0.25, 0.5, 0.75}深度量级，和{0.3, 0.5, 0.8}高度量级。然后对体素大小、三维位置和方向的每个组合进行评估。

### 结构化预测场景布局

我们再次使用公式（1）的S-SVM表述来预测曼哈顿布局立方体M=（L，θ，S）。损失函数Δ(M, ¯M)与公式（2）相同，只是我们使用了[35]中对IOU的 "自由空间 "定义，并考虑到方向只可识别为90◦旋转的事实。因为布局注释不一定有曼哈顿结构，所以地面真实布局被认为是具有最大自由空间IOU的立方体假设。

### 布局假设

我们将地面和天花板预测为沿重力方向的三维点的0.001和0.999的量级，并将方向离散为0到180◦之间的18个均匀的角度。然后，我们提出布局候选方案，这些方案至少捕捉了所有三维点的80%，并以最远和最近的三维点为界。对于典型的场景，有5,000-20,000种布局假设。更多细节见补充材料。

