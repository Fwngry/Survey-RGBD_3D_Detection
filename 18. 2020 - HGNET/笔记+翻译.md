# HGNet

## 摘要

点云上的三维物体检测有很多应用。然而，大多数已知的点云物体检测方法没有充分考虑到点云的特点（如稀疏性），因此一些关键的语义信息（如形状信息）没有被很好地捕获。在本文中，我们提出了一种新的基于图卷积（GConv）的层次图网络（HGNet）用于三维物体检测，**它直接处理原始点云以预测三维边界盒。**

1. **提取特征 - 设计SA-GConv（一种图卷积，用于U形网络，提取特征**）：HGNet有效地捕捉了点的关系，并利用多层次语义进行物体检测。特别是，我们提出了一种**新型的形状关注GConv（SA-GConv）**，通过对点的相对几何位置进行建模来捕捉局部形状特征，从而描述物体形状。一个基于SA-GConv的U型网络捕捉多层次的特征。
2. **生成建议 - 投票模块**：通过改进的投票模块将其映射到一个相同的特征空间，然后进一步利用它来产生建议。
3. **推理模块 - 生成预测边界框**：接下来，一个新的基于GConv的提案推理模块考虑到全局场景语义，对提案进行推理，然后预测边界框。

因此，我们的新框架在两个大规模的点云数据集上的表现优于最先进的方法，在SUN RGB-D上的平均精度（mAP）为4%∼，在ScanNet-V2上的平均精度为3%∼。

## HGnet

我们的目标是开发一种新的有效方法，用于点云上的三维物体检测。与二维图像数据不同的是，点云通常不呈现清晰的物体形状信息（例如，角和边缘），因此需要一些关注形状的特征提取器来处理点云。尽管以前的工作[42, 32, 41]隐含地使用了点的位置，但明确地对点的几何位置进行建模更为有效，它能更好地描述物体的形状。此外，多级语义被证明对检测各种尺寸的物体是有益的[43, 39, 34, 22]。另外，物体表面的点可能是稀疏的，因此，不同层次的语义可能会提供相互补充的信息。以前的许多三维物体检测研究没有充分地利用多层次语义，这对于处理具有不同大小的物体和点稀疏性的点云是不合适的。

在这项工作中，我们开发了一个端到端的层次图网络（HGNet），用于点云的三维物体检测，如图2所示。整个HGNet包含三个主要部分：一个基于GConv的U形网络（GUnet），一个提议生成器，以及一个提议推理模块（ProRe模块）。提出了一个新的关注形状的GConv来捕捉局部形状语义。GU-net产生多层次的语义，这些语义被聚合起来，由提案生成器生成提案。最后，ProRe模块通过利用全局场景语义来帮助预测边界框的建议。

下面我们将详细讨论第3.2节中新颖的形状关注（De）GConv，第3.3节中的GU-net，第3.4节中的提议生成器，第3.5节中的ProRe模块，以及第3.6节中的损失函数。

![image-20210629144200181](https://oj84-1259326782.cos.ap-chengdu.myqcloud.com/uPic/2021/06_29_image-20210629144200181.png)

## Module1：SA-GConv

### 1. 特征聚合 SA-GConv：减少点的数量，同时聚合特征的维度

采样：减少点的数量 + 聚合临近点的特征：模块设计如下⬇️

<img src="https://oj84-1259326782.cos.ap-chengdu.myqcloud.com/uPic/2021/06_29_06_29_image-20210629144316452.png" alt="image-20210629144316452" style="zoom: 67%;" />

最大池化（g：1x1卷积+softmax, f：MLP）

<img src="https://oj84-1259326782.cos.ap-chengdu.myqcloud.com/uPic/2021/06_29_06_29_image-20210629144244265.png" alt="image-20210629144244265" style="zoom:67%;" />

### 2. 特征扩展 SA-(De)GConv：增加点的数量，同时聚合特征的维度

（上采样）拓展点的数量 + 初始化特征-平均值 + 特征聚合-SA-GConv

<img src="https://oj84-1259326782.cos.ap-chengdu.myqcloud.com/uPic/2021/06_29_image-20210629144653411.png" alt="image-20210629144653411" style="zoom: 67%;" />

### 3.多层次语义：GU-net

为了捕捉多层次语义，我们提出了一个新的U型网络，称为GU-net，基于SA-（De）GConv。我们设计了一个下采样模块，反复堆叠4次形成下采样途径，而一个上采样模块反复堆叠两次构成上采样途径。与FPN[22]类似，GU-net用三点特征图生成一个特征金字塔（见图2）。

下采样模块。给定一个有N个点的点特征图，我们首先通过最远点采样（FPS）[27, 7, 32]对包含N（N < N）个点的子集进行采样。然后，我们通过kNN或球形查询在采样点周围构建局部区域，再通过执行SA-GConv更新采样点的特征。这样，一个点的特征图经过处理后，就可以生成一个点数较少的高一级的点特征图（例如，D4是由D3生成的）。

上采样模块。上采样模块的过程与下采样模块的过程相反，主要由SA-GConv完成。除了最上面的点特征图U4外，跳过的连接也是通过通道连接的方式来连接相应的点特征图（如U3和D3）。U4和D4是由MLP连接的。因此，GU-net输出一个具有三个点特征图的特征金字塔（见图2）。

## Module2:投票模块，生成proposal

improved voting module～SA-GConv+Vote Module

![image-20210629152445723](https://oj84-1259326782.cos.ap-chengdu.myqcloud.com/uPic/2021/06_29_06_29_image-20210629152445723.png)

SA-GConv来生成geo shifts偏置

### Module3：推理模块

![image-20210629154213321](https://oj84-1259326782.cos.ap-chengdu.myqcloud.com/uPic/2021/06_29_06_29_image-20210629154213321.png)

<img src="https://oj84-1259326782.cos.ap-chengdu.myqcloud.com/uPic/2021/06_29_image-20210629154236463.png" alt="image-20210629154236463" style="zoom:25%;" />：哈达马德积

<img src="https://oj84-1259326782.cos.ap-chengdu.myqcloud.com/uPic/2021/06_29_image-20210629154323776.png" alt="image-20210629154323776" style="zoom:15%;" />：哈达马德表示

<img src="https://oj84-1259326782.cos.ap-chengdu.myqcloud.com/uPic/2021/06_29_image-20210629154401632.png" alt="image-20210629154401632" style="zoom:25%;" /><img src="https://oj84-1259326782.cos.ap-chengdu.myqcloud.com/uPic/2021/06_29_image-20210629154416447.png" alt="image-20210629154416447" style="zoom:25%;" />：通道或顶点方向上的一维卷积